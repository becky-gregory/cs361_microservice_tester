<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Create user</title>
</head>
<body>
  <p><a href="index.html">Back to Microservice Tester</a></p>
  <h2>User â€“ POST Create user</h2>

  <p>
    <label for="user_id">User ID</label><br />
    <input type="text" id="user_id" />
  </p>
  <p>
    <label for="email">Email</label><br />
    <input type="text" id="email" />
  </p>
  <p>
    <label for="name">Name</label><br />
    <input type="text" id="name" />
  </p>
  <p>
    <input type="checkbox" id="is_public" />
    <label for="is_public">Is public</label>
  </p>
  <p><button type="button" id="submit">Send request</button></p>

  <div id="result" style="display: none;">
    <p id="resultStatus"></p>
    <pre id="resultBody"></pre>
  </div>

  <script>
    document.getElementById("submit").onclick = function() {
      var user_id = document.getElementById("user_id").value.trim();
      var email = document.getElementById("email").value.trim();
      var name = document.getElementById("name").value.trim();
      var is_public = document.getElementById("is_public").checked;
      var resultDiv = document.getElementById("result");
      var resultStatus = document.getElementById("resultStatus");
      var resultBody = document.getElementById("resultBody");

      resultDiv.style.display = "block";
      resultStatus.textContent = "Sending...";
      resultBody.textContent = "";

      fetch("/api/call", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          baseUrl: "http://127.0.0.1:8002",
          method: "POST",
          path: "/users",
          body: { user_id: user_id, email: email, name: name, is_public: is_public }
        })
      })
      .then(function(response) { return response.json(); })
      .then(function(data) {
        if (data.error) {
          resultStatus.textContent = "Request failed";
          resultBody.textContent = data.error;
        } else {
          resultStatus.textContent = "HTTP " + data.status;
          try {
            resultBody.textContent = JSON.stringify(JSON.parse(data.body), null, 2);
          } catch (e) {
            resultBody.textContent = data.body;
          }
        }
      })
      .catch(function(err) {
        resultStatus.textContent = "Request failed";
        resultBody.textContent = err.message;
      });
    };
  </script>
</body>
</html>
